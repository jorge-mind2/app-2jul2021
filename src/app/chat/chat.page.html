 <ion-header>
   <ion-toolbar color="primary">
     <ion-buttons slot="start">
       <ion-back-button [defaultHref]="defaultBackHref"
                        (click)="navigateHome()"></ion-back-button>
     </ion-buttons>
     <ion-buttons slot="end"
                  *ngIf="loginType=='therapist'">
       <ion-button (click)="presentCallAlert()">
         <ion-icon name="call"
                   size="large"></ion-icon>
       </ion-button>
       <ion-button (click)="presentModal()">
         <ion-icon name="calendar"
                   size="large"></ion-icon>
       </ion-button>
       <ion-button (click)="presentOptions($event)">
         <ion-icon name="more"
                   size="large"></ion-icon>
       </ion-button>
     </ion-buttons>
     <ion-title>
       <div class="title-block">
         <!-- <ion-icon name="user"
                   color="secondary"
                   class="title-icon"></ion-icon> -->
         <ion-text class="title-text"
                   *ngIf="loginType=='therapist'">{{patient.name}} {{patient.last_name}}</ion-text>
         <ion-text class="title-text"
                   *ngIf="loginType=='patient'">{{loggedUser.therapist.name}} {{loggedUser.therapist.last_name}}
         </ion-text>
       </div>
     </ion-title>
   </ion-toolbar>
 </ion-header>

 <ion-content #chatBox
              id="chat-parent"
              padding-vertical
              fullscreen>
   <!-- <ion-fab vertical="top"
            horizontal="end"
            edge
            slot="fixed"
            *ngIf="loginType=='therapist'">
     <ion-fab-button color="secondary">
       <ion-icon name="add"></ion-icon>
     </ion-fab-button>
     <ion-fab-list side="bottom">
       <ion-fab-button color="tertiary"
                       (click)="presentCallAlert()">
         <ion-icon name="call"></ion-icon>
       </ion-fab-button>
       <ion-fab-button color="tertiary"
                       (click)="presentModal()">
         <ion-icon name="calendar"></ion-icon>
       </ion-fab-button>
       <ion-fab-button color="tertiary"
                       (click)="presentPricePrompt()">
         <ion-icon name="cash"></ion-icon>
       </ion-fab-button>
     </ion-fab-list>
   </ion-fab> -->
   <!-- <div id="chat-parent"
        class="bg-image"
        [ngClass]="{ 'bg-image-X': phone_model=='iPhone X'}">
     <div id="chat-container"> -->
   <ion-row class="ion-no-margin"
            *ngIf="messages.length<=0">
     <ion-col size="12"
              size-md>
       <ion-card>
         <ion-card-content>
           <ion-text clas="ion-text-center">
             <p>
               Di <b>Hola</b> para iniciar a charlar con <b class="text-primary">{{receiverName}}</b>
             </p>
           </ion-text>
         </ion-card-content>
       </ion-card>

     </ion-col>
   </ion-row>
   <ion-row [ngClass]="{'ion-no-margin':i==0}"
            *ngFor="let message of messages; let i = index;"
            class="full no-padding">
     <div class="dateSeperatorCongtainer"
          *ngIf="( i===0?printDate(message.sentAt):printDate(message.sentAt,messages[i-1].sentAt))">
       <span class="dateSeperator">
         {{( i===0?printDate(message.sentAt):printDate(message.sentAt,messages[i-1].sentAt))}}
       </span>
     </div>
     <ion-col class="no-padding chat-row"
              [ngClass]="{ 'reverse': message.senderType}">
       <div class="avatar-parent">
         <div class="avatar-border"></div>
         <img [src]="message.image"
              class="avatar">
       </div>
       <div [ngClass]="{ 'name-row-parent-right': message.senderType,'name-row-parent-left': !message.senderType}">
         <div class="no-padding"
              [ngClass]="{ 'name-row-right': message.senderType,'name-row-left': !message.senderType}">
           {{message.sender}}

           <div [ngClass]="{ 'reverse-arc-right': message.senderType,'reverse-arc-left': !message.senderType}">
             <div
                  [ngClass]="{ 'reverse-arc-color-right': message.senderType,'reverse-arc-color-left': !message.senderType}">
             </div>
           </div>
         </div>
         <div class="no-padding"
              [ngClass]="{ 'message-row-right': message.senderType,'message-row-left': !message.senderType}">
           <ion-text class="ion-no-margin"
                     class="text">
             {{message.text}}
           </ion-text>
           <div [ngClass]="{ 'timer-right': message.senderType,'timer-left': !message.senderType}">
             {{message.sentAt *1000|date:'h:mm a' }}
             <ion-icon *ngIf="message.senderType && message.sent"
                       name="checkmark"
                       [color]="message.read ? 'primary': 'light'"
                       class="first-tick"></ion-icon>
             <ion-icon *ngIf="message.senderType && message.delivered"
                       name="checkmark"
                       [color]="message.read ? 'primary': 'light'"
                       class="second-tick"></ion-icon>
           </div>
         </div>
       </div>

     </ion-col>
   </ion-row>
   <!-- </div>
   </div> -->
 </ion-content>
 <ion-footer [ngClass]="{ 'custom-footer': phone_model=='iPhone X'}">
   <ion-row class="input-position"
            [ngClass]="{ 'custom-footer-row': phone_model=='iPhone X'}">
     <ion-col size="10">
       <ion-input class="input restrict ion-padding-start"
                  type="text"
                  placeholder="Type a message"
                  [(ngModel)]="input"
                  (keyup.enter)="sendChatMessage()"></ion-input>
     </ion-col>
     <ion-col size="2">
       <!-- <ion-button shape="round"
                   class="send-button"
                   color="secondary"
                   (click)="send()">
         <ion-text color="light">
           <ion-icon name="send"></ion-icon>
         </ion-text>
       </ion-button> -->
       <ion-fab-button color="primary"
                       size="small"
                       class="send-fab-button"
                       (click)="sendChatMessage()">
         <ion-icon name="send"
                   style="padding-left: 5px;"></ion-icon>
       </ion-fab-button>
     </ion-col>
   </ion-row>
 </ion-footer>